Consultas que respondem as questões para as regras de negócio
01 - Qual seria o número de cadastros atualmente no banco de dados ativos e inativos?
SELECT
  SUM(CASE WHEN ativo = 1 THEN 1 ELSE 0 END) AS TotalCadastrosAtivos,
  SUM(CASE WHEN ativo = 0 THEN 1 ELSE 0 END) AS TotalCadastrosInativos
  FROM Cliente;
CREATE INDEX idx_ativo ON Cliente(ativo);
DROP INDEX idx_ativo ON Cliente;


02 - Qual é número de transações diária efetuada pelos clientes?
SELECT
    CONVERT(date, T.data) AS DataTransacao,
    COUNT(*) AS NumeroTransacoes,
    C.nome AS Responsavel
FROM Transacao T
JOIN Cliente C ON T.id_cliente = C.id_cliente
GROUP BY CONVERT(date, T.data), C.nome;
CREATE INDEX idx_id_cliente ON Transacao(id_cliente);
CREATE INDEX idx_id_cliente_data ON Cliente(id_cliente);
DROP INDEX idx_id_cliente ON Transacao;
DROP INDEX idx_id_cliente_data ON Cliente;


03 - Qual o valor total movimentado anualmente pelos clientes?
SELECT
    YEAR(T.data) AS Ano,
    SUM(T.valor) AS ValorTotalMovimentado,
    C.nome AS Responsavel
FROM Transacao T
JOIN Cliente C ON T.id_cliente = C.id_cliente
WHERE YEAR(T.data) = 2020 -- Substitua pelo ano desejado
GROUP BY YEAR(T.data), C.nome;
CREATE INDEX idx_id_cliente ON Transacao(id_cliente);
CREATE INDEX idx_id_cliente ON Cliente(id_cliente);
DROP INDEX idx_id_cliente ON Transacao;
DROP INDEX idx_id_cliente ON Cliente;


04 - Qual o valor total arrecadado mensalmente com o câmbio de moeda?
SELECT SUBSTRING(CONVERT(varchar, dt_cambio, 120), 1, 7) AS Mes, SUM(valor_dest) AS ValorTotal
FROM Cambio
GROUP BY SUBSTRING(CONVERT(varchar, dt_cambio, 120), 1, 7)
ORDER BY Mes;
CREATE INDEX idx_dt_cambio ON Cambio (dt_cambio);
DROP INDEX idx_dt_cambio ON Cambio;
